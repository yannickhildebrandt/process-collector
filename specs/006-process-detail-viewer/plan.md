# Implementation Plan: Process Detail Viewer

**Branch**: `006-process-detail-viewer` | **Date**: 2026-02-24 | **Spec**: [spec.md](spec.md)
**Input**: Feature specification from `/specs/006-process-detail-viewer/spec.md`

## Summary

Redesign the process detail page from stacked cards to a side-by-side layout: a large BPMN diagram viewer (flex-1) on the left with the text summary in a fixed-width sidebar (w-96) on the right. On mobile (<1024px), switch to a tabbed interface reusing the same pattern as the interview page. Handle content variations (BPMN only, markdown only, neither) with conditional layout rendering. No schema changes — purely a frontend layout rewrite.

## Technical Context

**Language/Version**: TypeScript 5.x, Node.js 22+
**Primary Dependencies**: Next.js 16.1.6, React 19, bpmn-js 18 (NavigatedViewer), next-intl 4, Tailwind CSS v4
**Storage**: N/A (no schema changes)
**Testing**: Manual testing per quickstart.md checklist
**Target Platform**: Browser (desktop 1024px+, mobile 375px+)
**Project Type**: Web application (Next.js App Router)
**Performance Goals**: Page load with BPMN + markdown under 3 seconds
**Constraints**: BPMN viewer requires explicit container dimensions; must remain client-side only (dynamic import)
**Scale/Scope**: Single page rewrite + i18n keys + optional loading skeleton update

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Principle | Status | Notes |
|-----------|--------|-------|
| I. AI-Guided, Not AI-Replaced | PASS | No AI involvement — read-only view of existing data |
| II. Self-Service by Design | PASS | Layout improves usability; diagram is front-and-center for employees/consultants |
| III. Structured Output over Free Text | PASS | Displays existing BPMN + markdown structured artifacts |
| IV. Configuration as Data, Not Code | PASS | No configuration changes; layout is universal |
| V. LLM-Agnostic by Architecture | PASS | No LLM interaction in this feature |

All gates pass. No violations.

## Project Structure

### Documentation (this feature)

```text
specs/006-process-detail-viewer/
├── plan.md              # This file
├── spec.md              # Feature specification
├── research.md          # Phase 0 output (5 decisions)
├── data-model.md        # Phase 1 output (no schema changes)
├── quickstart.md        # Phase 1 output (test checklist)
├── checklists/
│   └── requirements.md  # Spec quality validation
└── tasks.md             # Phase 2 output (generated by /speckit.tasks)
```

### Source Code (repository root)

```text
src/
├── app/[locale]/projects/[projectId]/processes/[processId]/
│   └── page.tsx                    # REWRITE: Side-by-side layout with tabbed mobile fallback
├── components/processes/
│   ├── bpmn-viewer.tsx             # EXISTING: Reuse with dynamic height prop
│   └── markdown-viewer.tsx         # EXISTING: Reuse in sidebar panel
└── i18n/messages/
    ├── en.json                     # UPDATE: Add tabDiagram, tabDocumentation, noContent keys
    └── de.json                     # UPDATE: Add tabDiagram, tabDocumentation, noContent keys
```

**Structure Decision**: This is a single-page layout rewrite within the existing Next.js App Router structure. No new directories, components, or API routes needed. The existing `BpmnViewer` and `MarkdownViewer` components are reused as-is — only the page that composes them changes.

### Key Implementation Details

**Layout (desktop, lg+)**:
- Outer container: `flex gap-6` with `h-[calc(100vh-10rem)]`
- BPMN area: `flex-1 min-w-0` — takes remaining space (~65-75%)
- Sidebar: `w-96 overflow-y-auto` — fixed 384px, independently scrollable
- BpmnViewer height: `100%` (fills parent container)

**Layout (mobile, <lg)**:
- Tab bar with "Diagram" / "Documentation" buttons
- CSS-based visibility toggle (`hidden`/`block`) to keep both components mounted
- State: `activeTab: "diagram" | "documentation"`

**Content variations**:
- Both present → side-by-side (desktop) / tabs (mobile)
- BPMN only → full-width diagram, no sidebar/tabs
- Markdown only → full-width documentation, no sidebar/tabs
- Neither → empty state card with message

**i18n keys** (under `processes` namespace):
- `tabDiagram`: "Diagram" / "Diagramm"
- `tabDocumentation`: "Documentation" / "Dokumentation"
- `noContent`: "This process has not been documented yet." / "Dieser Prozess wurde noch nicht dokumentiert."
